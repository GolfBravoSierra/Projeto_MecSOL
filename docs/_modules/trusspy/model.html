
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>trusspy.model &#8212; TrussPy 2018.08 documentation</title>
    <link rel="stylesheet" href="../../_static/sphinx13.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2018.08',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="canonical" href="http://www.sphinx-doc.org/en/master/_modules/trusspy/model.html" />

    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
    </style>
    <script type="text/javascript">
      // intelligent scrolling of the sidebar content
      $(window).scroll(function() {
        var sb = $('.sphinxsidebarwrapper');
        var win = $(window);
        var sbh = sb.height();
        var offset = $('.sphinxsidebar').position()['top'];
        var wintop = win.scrollTop();
        var winbot = wintop + win.innerHeight();
        var curtop = sb.position()['top'];
        var curbot = curtop + sbh;
        // does sidebar fit in window?
        if (sbh < win.innerHeight()) {
          // yes: easy case -- always keep at the top
          sb.css('top', $u.min([$u.max([0, wintop - offset - 10]),
                                $(document).height() - sbh - 200]));
        } else {
          // no: only scroll if top/bottom edge of sidebar is at
          // top/bottom edge of window
          if (curtop > wintop && curbot > winbot) {
            sb.css('top', $u.max([wintop - offset - 10, 0]));
          } else if (curtop < wintop && curbot < winbot) {
            sb.css('top', $u.min([winbot - sbh - offset - 20,
                                  $(document).height() - sbh - 200]));
          }
        }
      });
    </script>

  </head>
  <body>
<div class="pageheader">
    <div >
        <a href="https://github.com/you"><img style="position: absolute; top: 0; left: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_left_red_aa0000.png" alt="Fork me on GitHub"></a>
    </div>
  <ul>
    <li><a href="../../index.html">Home</a></li>
    <li><a href="../../usage/install.html">Get it</a></li>
    <li><a href="../../usage/getting_started.html">Quickstart</a></li>
    <li><a href="../../theory/theory.html">Theory Guide</a></li>
  </ul>
  <div>
    <a href="../../index.html">
      <img src="../../_static/sphinxheader.png" alt="TRUSSPY" />
    </a>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">Home</a>&#160;|</li>
        <li><a href="../../usage/getting_started.html">Quickstart</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for trusspy.model</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Created on Wed Jun 27 21:08:10 2018</span>

<span class="sd">@author: adutz</span>

<span class="sd">    TrussPy - Object Oriented Truss Solver for Python</span>
<span class="sd">    Copyright (C) 2018  Andreas Dutzler</span>

<span class="sd">    This program is free software: you can redistribute it and/or modify</span>
<span class="sd">    it under the terms of the GNU General Public License as published by</span>
<span class="sd">    the Free Software Foundation, either version 3 of the License, or</span>
<span class="sd">    (at your option) any later version.</span>

<span class="sd">    This program is distributed in the hope that it will be useful,</span>
<span class="sd">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="sd">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="sd">    GNU General Public License for more details.</span>

<span class="sd">    You should have received a copy of the GNU General Public License</span>
<span class="sd">    along with this program.  If not, see &lt;https://www.gnu.org/licenses/&gt;.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="c1"># Numpy and Pandas</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Handler Classes</span>
<span class="kn">from</span> <span class="nn">.handlers</span> <span class="k">import</span> <span class="n">SettingsHandler</span>
<span class="kn">from</span> <span class="nn">.handlers</span> <span class="k">import</span> <span class="n">NodeHandler</span>
<span class="kn">from</span> <span class="nn">.handlers</span> <span class="k">import</span> <span class="n">ElementHandler</span>
<span class="kn">from</span> <span class="nn">.handlers</span> <span class="k">import</span> <span class="n">BoundaryHandler</span>
<span class="kn">from</span> <span class="nn">.handlers</span> <span class="k">import</span> <span class="n">ExternalForceHandler</span>
<span class="kn">from</span> <span class="nn">.handlers</span> <span class="k">import</span> <span class="n">ResultHandler</span>

<span class="c1"># Analysis Class</span>
<span class="kn">from</span> <span class="nn">.core</span> <span class="k">import</span> <span class="n">Analysis</span>

<span class="c1">#from scipy.optimize import fsolve</span>

<span class="c1"># Material Definition</span>
<span class="kn">from</span> <span class="nn">.materials</span> <span class="k">import</span> <span class="n">umat_el</span><span class="p">,</span> <span class="n">umat_elplast_iso</span>

<span class="c1"># Element Definition</span>
<span class="kn">from</span> <span class="nn">.elements</span> <span class="k">import</span> <span class="n">truss</span>

<span class="c1"># Solver and Tools</span>
<span class="kn">from</span> <span class="nn">.solvers</span> <span class="k">import</span> <span class="n">pathfollow</span>
<span class="kn">from</span> <span class="nn">.tools</span> <span class="k">import</span> <span class="p">(</span><span class="n">p_nodes</span><span class="p">,</span><span class="n">p_elements</span><span class="p">,</span><span class="n">p_extforces</span><span class="p">,</span>
                    <span class="n">p_model</span><span class="p">,</span><span class="n">p_movie</span><span class="p">,</span><span class="n">p_history</span><span class="p">,</span><span class="n">p_path</span><span class="p">,</span><span class="n">p_show</span><span class="p">)</span>

<div class="viewcode-block" id="Model"><a class="viewcode-back" href="../../api/trusspy.model.html#trusspy.model.Model">[docs]</a><span class="k">class</span> <span class="nc">Model</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Model Class with Nodes, Elements, Boundaries, etc.</span>
<span class="sd">    </span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    stdout : sys.stdout</span>
<span class="sd">        get current stdout</span>
<span class="sd">        </span>
<span class="sd">    file : None or str</span>
<span class="sd">        name of input file (default is None)</span>
<span class="sd">        </span>
<span class="sd">    log : int</span>
<span class="sd">        Level of collecting logging informations during analysis.</span>
<span class="sd">        Higher numbers will collect more informations (default is 2).</span>
<span class="sd">        </span>
<span class="sd">    logfile : boolean</span>
<span class="sd">        flag for logfile creation (default is True)</span>
<span class="sd">        </span>
<span class="sd">    Nodes : NodeHandler</span>
<span class="sd">        Handles all nodes inside the model</span>
<span class="sd">        </span>
<span class="sd">    Elements : ElementHandler</span>
<span class="sd">        Handles all elements inside the model</span>
<span class="sd">        </span>
<span class="sd">    Boundaries : BoundaryHandler</span>
<span class="sd">        Handles all boundaries inside the model</span>
<span class="sd">        </span>
<span class="sd">    ExtForces : ExternalForceHandler</span>
<span class="sd">        Handles all external forces inside the model</span>
<span class="sd">        </span>
<span class="sd">    Analysis : AnalysisHandler</span>
<span class="sd">        Handles all data for one increment</span>
<span class="sd">        </span>
<span class="sd">    Results : ResultHandler</span>
<span class="sd">        Handles all result data inside the model.</span>
<span class="sd">        A collection of all converged analysis solutions.</span>
<span class="sd">        </span>
<span class="sd">    Settings : SettingsHandler</span>
<span class="sd">        Handles all model parameters inside the model</span>
<span class="sd">    </span>
<span class="sd">    Todo</span>
<span class="sd">    ----</span>
<span class="sd">    * move g(V), dgdV(V) from Model class to path_tracing function</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">log</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">logfile</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Init Model class with default values. If input file is specified,</span>
<span class="sd">        collect all data and create model.</span>
<span class="sd">        </span>
<span class="sd">        Parameter</span>
<span class="sd">        ---------</span>
<span class="sd">        file : None or str, optional</span>
<span class="sd">            name of input file (default is None)</span>
<span class="sd">            </span>
<span class="sd">        log : int</span>
<span class="sd">            Level of collecting logging informations during analysis.</span>
<span class="sd">            Higher numbers will collect more informations (default is 2).</span>
<span class="sd">            </span>
<span class="sd">        logfile : boolean, optional</span>
<span class="sd">            flag for logfile creation (default is True)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="n">file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logfile</span> <span class="o">=</span> <span class="n">logfile</span>
        <span class="k">if</span> <span class="n">file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">pass</span>
            <span class="c1">#self.logfile = False</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">logfile_name</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logfile_name</span> <span class="o">=</span> <span class="s1">&#39;analysis&#39;</span>
            <span class="c1">#self.logfile = False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">logfile_name</span><span class="o">+</span><span class="s1">&#39;.log&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
            
            
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">         _____                  ______      </span>
<span class="s2">        |_   _|                 | ___ \     </span>
<span class="s2">          | |_ __ _   _ ___ ___ | |_/ /   _ </span>
<span class="s2">          | | &#39;__| | | / __/ __||  __/ | | |</span>
<span class="s2">          | | |  | |_| \__ \__ \| |  | |_| |</span>
<span class="s2">          \_/_|   \__,_|___/___/\_|   \__, |</span>
<span class="s2">                                       __/ |</span>
<span class="s2">                                      |___/ </span>
<span class="s2">        </span>
<span class="s2">        TrussPy - Object Oriented Truss Solver for Python</span>
<span class="s2">                  SNAPSHOT-20180807</span>

<span class="s2">        Author: Dutzler A.</span>
<span class="s2">                Graz University of Technology, 2018</span>
<span class="s2">                </span>
<span class="s2">        TrussPy  Copyright (C) 2018  Andreas Dutzler</span>
<span class="s2">        This program comes with ABSOLUTELY NO WARRANTY; </span>
<span class="s2">        for details type `trusspy.show_w()&#39;.</span>
<span class="s2">        This is free software, and you are welcome to redistribute it</span>
<span class="s2">        under certain conditions; type `trusspy.show_c()&#39; for details.</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">log</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">log</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Initialize Model...&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">log</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">88</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">log</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; loading Managers...&#39;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">Nodes</span> <span class="o">=</span> <span class="n">NodeHandler</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Elements</span> <span class="o">=</span> <span class="n">ElementHandler</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Boundaries</span> <span class="o">=</span> <span class="n">BoundaryHandler</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ExtForces</span> <span class="o">=</span> <span class="n">ExternalForceHandler</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Settings</span> <span class="o">=</span> <span class="n">SettingsHandler</span><span class="p">()</span>
        <span class="c1">#self.Results = ResultHandler()</span>
        <span class="c1">#self.Analysis = Analysis()</span>
        
        <span class="k">if</span> <span class="n">log</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; ...finished.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">log</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">88</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">log</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; loading INPUT-File: &quot;&#39;</span><span class="o">+</span><span class="n">file</span><span class="o">+</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
            <span class="n">Nodes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;Nodes&quot;</span><span class="p">,</span><span class="n">skiprows</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()[:,:</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
            <span class="n">Elements</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;Elements&quot;</span><span class="p">,</span><span class="n">skiprows</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()[:,:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
            <span class="n">Material</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;Material&quot;</span><span class="p">,</span><span class="n">skiprows</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()[:,:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
            <span class="n">Geometry</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;Geometry&quot;</span><span class="p">,</span><span class="n">skiprows</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()[:,:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
            <span class="n">ExtForces</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;ExternalForces&quot;</span><span class="p">,</span><span class="n">skiprows</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()[:,:</span><span class="mi">1</span><span class="o">+</span><span class="mi">5</span><span class="o">*</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
            <span class="n">Boundary_U</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;BoundaryU&quot;</span><span class="p">,</span><span class="n">skiprows</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()[:,:</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
            <span class="n">Boundary_T</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;BoundaryT&quot;</span><span class="p">,</span><span class="n">skiprows</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()[:,:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">log</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; ...successful.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">log</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Converting Data...&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Nodes</span><span class="o">.</span><span class="n">add_node_matrix</span><span class="p">(</span><span class="n">Nodes</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Elements</span><span class="o">.</span><span class="n">add_element_matrix</span><span class="p">(</span><span class="n">Elements</span><span class="p">,</span><span class="n">Material</span><span class="p">,</span><span class="n">Geometry</span><span class="p">,</span><span class="n">Boundary_T</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ExtForces</span><span class="o">.</span><span class="n">add_force_matrix</span><span class="p">(</span><span class="n">ExtForces</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Boundaries</span><span class="o">.</span><span class="n">add_bound_U_matrix</span><span class="p">(</span><span class="n">Boundary_U</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">log</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; ...Import finised.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">log</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">88</span><span class="p">)</span>
    
<div class="viewcode-block" id="Model.build"><a class="viewcode-back" href="../../api/trusspy.model.html#trusspy.model.Model.build">[docs]</a>    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;build Model (r,U,K,...) with Model data and dimensions.&quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">Results</span> <span class="o">=</span> <span class="n">ResultHandler</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span> <span class="o">=</span> <span class="n">Analysis</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">clock0_build</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">clock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time0_build</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        
        <span class="c1"># initialize numbers: #nodes, #elements, #dof</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nnodes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nodes</span><span class="o">.</span><span class="n">labels</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nelems</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Elements</span><span class="o">.</span><span class="n">labels</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">ndim</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ndof</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nnodes</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span>
        
        <span class="c1"># fix node sorting, undefined boundaries and undefined external forces</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Nodes</span><span class="o">.</span><span class="n">fix_nodes</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Boundaries</span><span class="o">.</span><span class="n">fix_bounds_U</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nodes</span><span class="o">.</span><span class="n">labels</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ExtForces</span><span class="o">.</span><span class="n">fix_forces</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nodes</span><span class="o">.</span><span class="n">labels</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nodes</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Boundaries</span><span class="o">.</span><span class="n">Unodes</span><span class="p">)</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nodes</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ExtForces</span><span class="o">.</span><span class="n">nodes</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;Node sorting failed.&#39;</span><span class="p">)</span>
        
        <span class="c1"># init state variables for plasticity</span>
        <span class="k">if</span> <span class="mi">2</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Elements</span><span class="o">.</span><span class="n">mat_type</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">nstatev</span> <span class="o">=</span> <span class="mi">2</span>
        
        <span class="c1"># node properties</span>
        <span class="c1"># n----pro-------</span>
        <span class="c1">#</span>
        <span class="c1">#      active = free  = 1</span>
        <span class="c1">#    inactive = fixed = 0</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">nproBC</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Boundaries</span><span class="o">.</span><span class="n">Uvalues</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nproDOF</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ndof</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nnodes</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nproDOF0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nproDOF</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nproBC</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nproDOF1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nproDOF</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nproBC</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ndof0</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nproDOF0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ndof1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nproDOF1</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">log</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> 
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Build Model...&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">88</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Analysis Dimension ...&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">ndim</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Number of Nodes    ...&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nnodes</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Number of Elements ...&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nelems</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; System DOF ...&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndof</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; active DOF ...&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndof1</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; locked DOF ...&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndof0</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; active DOF ...&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nproDOF1</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; fixed  DOF ...&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nproDOF0</span><span class="p">)</span>
            
        <span class="c1"># init results, add empty increment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Results</span><span class="o">.</span><span class="n">add_increment</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nnodes</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">nelems</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">nproDOF0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">nproDOF1</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">nstatev</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Results</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">clock1_build</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">clock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time1_build</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span></div>
            
<div class="viewcode-block" id="Model.run"><a class="viewcode-back" href="../../api/trusspy.model.html#trusspy.model.Model.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Run job.&quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">log</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> 
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Run Simulation...&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">88</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">log</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Settings summary:&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-----------------</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Maximum increments                    &quot;incs&quot;:&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">incs</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Maximum increment recycles            &quot;cycl&quot;:&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">cycl</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Maximum Newton-Rhapson iterations     &quot;nfev&quot;:&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">nfev</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Maximum incremental displacement        &quot;du&quot;:&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">du</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Maximum incremental LPF               &quot;dlpf&quot;:&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">dlpf</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Initial control component               &quot;j0&quot;:&#39;</span><span class="p">,</span> <span class="s1">&#39;LPF&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">j0</span><span class="o">==</span><span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">j0</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Locked control component           &quot;j_fixed&quot;:&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">j_fixed</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Maximum incremental overshoot        &quot;dxtol&quot;:&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">dxtol</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Tolerance for x                       &quot;xtol&quot;:&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">xtol</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Tolerance for f                       &quot;ftol&quot;:&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">ftol</span><span class="p">)</span>
            
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Adaptive control for stepwidth &quot;inc.control&quot;:&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">stepcontrol</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">stepcontrol</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;+ Minimum step size factor          &quot;minfac&quot;:&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">minfac</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;+ Maximum step size factor          &quot;maxfac&quot;:&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">maxfac</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;+ Reduce step size factor           &quot;reduce&quot;:&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">reduce</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;+ Increase step size factor       &quot;increase&quot;:&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">increase</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="c1"># stiffness matrix, extended to nDOF+1</span>
        <span class="k">def</span> <span class="nf">dgdV</span><span class="p">(</span><span class="n">Vred</span><span class="p">,</span><span class="n">V0red</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">Vmax</span><span class="p">,</span><span class="n">analysis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">statev_write</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            
            <span class="k">if</span> <span class="n">analysis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span> <span class="o">=</span> <span class="n">analysis</span>
            
            <span class="c1"># copy active control component to current result</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">j</span> <span class="o">=</span> <span class="n">j</span>
            
            <span class="c1"># qc ... control equation</span>
            <span class="n">qc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ndof1</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">qc</span><span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="c1"># f0red ... external force vector f0 with active DOF</span>
            <span class="c1">#           reshaped to column-vector</span>
            
            <span class="c1"># modified stiffness</span>
            <span class="c1">#</span>
            <span class="c1">#          | KT       f0red |</span>
            <span class="c1"># KT_mod = | qcU  qc_lambda |</span>
            
            
            <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">Kmod</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">stiffness</span><span class="p">(</span><span class="n">Vred</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">analysis</span><span class="o">=</span><span class="n">analysis</span><span class="p">),</span>
                                                 <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">f0red</span><span class="p">)),</span><span class="n">qc</span><span class="p">))</span>
            
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">Kmod</span>
        
        <span class="c1"># equilibrium function, extended to nDOF+1</span>
        <span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">Vred</span><span class="p">,</span><span class="n">V0red</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">Vmax</span><span class="p">,</span><span class="n">analysis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">statev_write</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            
            <span class="k">if</span> <span class="n">analysis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span> <span class="o">=</span> <span class="n">analysis</span>
            
            <span class="c1"># copy active control component to current result</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">j</span> <span class="o">=</span> <span class="n">j</span>
            
            <span class="c1"># negative sign for default newton-rhapson function</span>
            <span class="c1">#if statev_write:</span>
            <span class="c1">#    print(&#39;xxx&#39;)</span>
            <span class="c1">#    return analysis</span>
            <span class="c1">#else:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">equilibrium</span><span class="p">(</span><span class="n">Vred</span><span class="p">,</span><span class="n">V0red</span><span class="p">,</span><span class="n">analysis</span><span class="o">=</span><span class="n">analysis</span><span class="p">,</span><span class="n">statev_write</span><span class="o">=</span><span class="n">statev_write</span><span class="p">),</span>
                             <span class="n">Vred</span><span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">Vmax</span><span class="p">)</span>
            
        <span class="c1"># measure time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time0_run</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clock0_run</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">clock</span><span class="p">()</span>
        
        
        <span class="c1"># reduced modified displacement vector to active DOF and LPF</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">Vred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">Ured</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">lpf</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="c1"># init LPF</span>
        <span class="c1"># self.Settings.lpf = self.Settings.dlpf</span>
        <span class="c1">#self.Analysis.lpf = self.Settings.dlpf</span>
        
        <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">nsteps</span><span class="p">):</span>
            
            <span class="c1"># maximum number of increment and maximum value per step</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">incs</span><span class="p">)</span> <span class="o">==</span> <span class="nb">tuple</span><span class="p">:</span>
                <span class="n">incs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">incs</span><span class="p">[</span><span class="n">step</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">incs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">incs</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">xlimit</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">tuple</span><span class="p">:</span>
                <span class="n">xlimit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">xlimit</span><span class="p">[</span><span class="n">step</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">xlimit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">xlimit</span>
                
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">log</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="mi">21</span><span class="o">*</span><span class="s1">&#39;+&#39;</span><span class="o">+</span><span class="s1">&#39; START OF STEP     &#39;</span><span class="p">,</span> <span class="n">step</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">45</span><span class="o">*</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>
            <span class="c1"># get reduced external force vector</span>
            <span class="c1">#f0red = self.ExtForces.forces[:,3*(step):3*(step+1)].flatten()[self.Analysis.DOF1]</span>
            <span class="c1">#self.Analysis.f0red = f0red.reshape(len(f0red),1)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">ExtForces</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ExtForces</span><span class="p">)</span>
            
            <span class="n">f0_const</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ExtForces</span><span class="o">.</span><span class="n">forces</span><span class="p">[:,</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">step</span><span class="p">):</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">step</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span>
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">step</span><span class="p">):</span>
                <span class="n">f0_const</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Results</span><span class="o">.</span><span class="n">step_lpf_end</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">ExtForces</span><span class="o">.</span><span class="n">forces</span><span class="p">[:,</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">s</span><span class="p">):</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">s</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">step</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">constant part of external forces due to previous step(s)&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">f0_const</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">initial values of active DOF due to previous step(s)&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">Vred</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">ExtForces</span><span class="o">.</span><span class="n">forces_const</span> <span class="o">=</span> <span class="n">f0_const</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">ExtForces</span><span class="o">.</span><span class="n">forces</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ExtForces</span><span class="o">.</span><span class="n">forces</span><span class="p">[:,</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">step</span><span class="p">):</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">step</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
            <span class="n">f0red</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">ExtForces</span><span class="o">.</span><span class="n">forces</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">DOF1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">f0red</span> <span class="o">=</span> <span class="n">f0red</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">f0red</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">step</span> <span class="o">=</span> <span class="mi">1</span><span class="o">+</span><span class="n">step</span>
            
            
            <span class="n">res_V</span><span class="p">,</span><span class="n">res_a</span> <span class="o">=</span> <span class="n">pathfollow</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">dgdV</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">Vred</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="p">,</span>
                             <span class="n">dxmax</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">du</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">dlpf</span><span class="p">],</span>
                             <span class="n">j</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">j0</span><span class="p">,</span>
                             <span class="n">j_fixed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">j_fixed</span><span class="p">,</span>
                             <span class="n">xlimit</span> <span class="o">=</span> <span class="n">xlimit</span><span class="p">,</span>
                             <span class="n">incs</span><span class="o">=</span><span class="n">incs</span><span class="p">,</span>
                             <span class="n">nfev</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">nfev</span><span class="p">,</span>
                             <span class="n">cycl</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">cycl</span><span class="p">,</span>
                             <span class="n">ftol</span><span class="o">=</span><span class="mi">10</span><span class="o">**-</span><span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">ftol</span><span class="p">,</span>
                             <span class="n">xtol</span><span class="o">=</span><span class="mi">10</span><span class="o">**-</span><span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">xtol</span><span class="p">,</span>
                             <span class="n">stepcontrol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">stepcontrol</span><span class="p">,</span>
                             <span class="n">maxfac</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">maxfac</span><span class="p">,</span>
                             <span class="n">minfac</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">minfac</span><span class="p">,</span>
                             <span class="n">reduce</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">reduce</span><span class="p">,</span>
                             <span class="n">increase</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">increase</span><span class="p">,</span>
                             <span class="n">dxtol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">dxtol</span><span class="p">,</span>
                             <span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>
            
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Create result object from analysis results for step </span><span class="si">{0:3d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">step</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,(</span><span class="n">r_V</span><span class="p">,</span><span class="n">r_a</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">res_V</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span><span class="n">res_a</span><span class="p">[</span><span class="mi">1</span><span class="p">:])):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  write result </span><span class="si">{0:3d}</span><span class="s1">/</span><span class="si">{1:3d}</span><span class="s1"> (LPF: </span><span class="si">{2:8.4f}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">res_V</span><span class="p">[</span><span class="mi">1</span><span class="p">:]),</span><span class="n">r_a</span><span class="o">.</span><span class="n">lpf</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Results</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_a</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Results</span><span class="o">.</span><span class="n">copy_increment</span><span class="p">()</span>
                
            <span class="c1"># copy initial U0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Results</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">U0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Results</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">U</span><span class="p">)</span>
            
            <span class="c1"># append last lpf value</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Results</span><span class="o">.</span><span class="n">step_lpf_end</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Results</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lpf</span><span class="p">)</span>
            
            <span class="c1"># reset LPF for new step</span>
            <span class="k">if</span> <span class="n">step</span><span class="o">+</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">nsteps</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">Vred</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">lpf</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Results</span><span class="o">.</span><span class="n">remove_last_increment</span><span class="p">()</span>
                
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">log</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="mi">23</span><span class="o">*</span><span class="s1">&#39;+&#39;</span><span class="o">+</span><span class="s1">&#39; END OF STEP     &#39;</span><span class="p">,</span> <span class="n">step</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">45</span><span class="o">*</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>
            
        <span class="c1"># duplicate first increment to get right indices</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Results</span><span class="o">.</span><span class="n">duplicate_first_increment</span><span class="p">()</span>
            
        <span class="n">time_dclock_run</span>   <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">clock</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">clock0_run</span>
        <span class="n">time_dtime_run</span>    <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>  <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">time0_run</span>
        <span class="n">time_dclock_build</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">clock1_build</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">clock0_build</span>
        <span class="n">time_dtime_build</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time1_build</span>  <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">time0_build</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">total  cpu time &quot;build&quot;: </span><span class="si">{:10.3f}</span><span class="s1"> seconds&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">time_dclock_build</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;total wall time &quot;build&quot;: </span><span class="si">{:10.3f}</span><span class="s1"> seconds</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">time_dtime_build</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">total  cpu time &quot;run&quot;: </span><span class="si">{:10.3f}</span><span class="s1"> seconds&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">time_dclock_run</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;total wall time &quot;run&quot;: </span><span class="si">{:10.3f}</span><span class="s1"> seconds</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">time_dtime_run</span><span class="p">))</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stdout</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">total  cpu time &quot;build&quot;: </span><span class="si">{:10.3f}</span><span class="s1"> seconds&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">time_dclock_build</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;total wall time &quot;build&quot;: </span><span class="si">{:10.3f}</span><span class="s1"> seconds</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">time_dtime_build</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">total  cpu time &quot;run&quot;: </span><span class="si">{:10.3f}</span><span class="s1"> seconds&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">time_dclock_run</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;total wall time &quot;run&quot;: </span><span class="si">{:10.3f}</span><span class="s1"> seconds</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">time_dtime_run</span><span class="p">))</span></div>
        

<div class="viewcode-block" id="Model.stiffness"><a class="viewcode-back" href="../../api/trusspy.model.html#trusspy.model.Model.stiffness">[docs]</a>    <span class="k">def</span> <span class="nf">stiffness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Ured</span><span class="p">,</span><span class="n">analysis</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="s2">&quot;Method for Stiffness Matrix.&quot;</span>
        
        <span class="c1"># In a future version this function should be implemented in Stiffness class part of the Model or Results</span>
        <span class="c1"># self.Stiffness(reduced=True)</span>
        
        <span class="c1"># it re-shapes stiffness matrix to</span>
        <span class="c1"># K(nnodes,nnodes,ndim,ndim) --&gt; K(nnodes*ndim,nnodes*nim)</span>
        <span class="c1"># and returns a view on the reduced (active part of the) matrix</span>
        <span class="c1"># K(nnodes*ndim,nnodes*nim)[active DOF rows][:,active DOF columns]</span>
        
        <span class="k">if</span> <span class="n">analysis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span> <span class="o">=</span> <span class="n">analysis</span>
        
        <span class="c1"># generate stiffness</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">equilibrium</span><span class="p">(</span><span class="n">Ured</span><span class="p">,</span><span class="n">Ured</span><span class="p">,</span><span class="n">stage</span><span class="o">=</span><span class="s1">&#39;K&#39;</span><span class="p">)</span>
        
        <span class="c1"># init re-shaped output stiffness matrix</span>
        <span class="n">K_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nnodes</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nnodes</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">))</span>

        <span class="c1"># loop over nodes to reshape K</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nnodes</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nnodes</span><span class="p">):</span>
                <span class="n">K_out</span><span class="p">[</span><span class="n">a</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">:</span><span class="n">a</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">,</span>
                      <span class="n">b</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">:</span><span class="n">b</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">K</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span>

        <span class="c1"># select only active DOF1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">Kred</span> <span class="o">=</span> <span class="n">K_out</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">DOF1</span><span class="p">][:,</span><span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">DOF1</span><span class="p">]</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">Kred</span></div>
            
        
<div class="viewcode-block" id="Model.equilibrium"><a class="viewcode-back" href="../../api/trusspy.model.html#trusspy.model.Model.equilibrium">[docs]</a>    <span class="k">def</span> <span class="nf">equilibrium</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Ured</span><span class="p">,</span><span class="n">U0red</span><span class="p">,</span><span class="n">stage</span><span class="o">=</span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="n">analysis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">statev_write</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to generate equilibrium for given displacements and external forces.&quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">analysis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span> <span class="o">=</span> <span class="n">analysis</span>

        <span class="c1"># remove last entry in Vred to get only displacement DOFs</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Ured</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndof1</span><span class="p">:</span>
            <span class="n">lpf</span>   <span class="o">=</span>  <span class="n">Ured</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">lpf0</span>  <span class="o">=</span> <span class="n">U0red</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">Ured</span>  <span class="o">=</span>  <span class="n">Ured</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">ndof1</span><span class="p">]</span>
            <span class="n">U0red</span> <span class="o">=</span> <span class="n">U0red</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">ndof1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lpf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">lpf</span>
            
        <span class="k">if</span> <span class="n">stage</span><span class="o">==</span><span class="s1">&#39;G&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1">#stage==&#39;K&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">K</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
            
            
        <span class="c1"># copy input Ured to appropriate positions in full U-vector</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),))[</span><span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">DOF1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Ured</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">U0</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">U0</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),))[</span><span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">DOF1</span><span class="p">]</span> <span class="o">=</span> <span class="n">U0red</span>
        
        <span class="c1"># loop over elements</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Elements</span><span class="o">.</span><span class="n">labels</span><span class="p">:</span>
            <span class="n">nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Elements</span><span class="o">.</span><span class="n">get_nodes</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="c1"># connected nodes</span>
            
            <span class="n">mat_prop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Elements</span><span class="o">.</span><span class="n">get_material_properties</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>  <span class="c1"># material parameter</span>
            <span class="n">geo_prop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Elements</span><span class="o">.</span><span class="n">get_geometric_properties</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="c1"># geometric parameter</span>
            
            <span class="c1"># undeformed coordinates of begin and end nodes</span>
            <span class="n">Xnodes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">n</span><span class="p">,</span><span class="n">node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nodes</span><span class="p">):</span>
                <span class="n">Xnodes</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nodes</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nodes</span><span class="o">.</span><span class="n">labels</span> <span class="o">==</span> <span class="n">node</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span>
            
            <span class="c1"># displacements at begin and end nodes</span>
            <span class="n">Unodes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">n</span><span class="p">,</span><span class="n">node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nodes</span><span class="p">):</span>
                <span class="n">Unodes</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">U</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nodes</span><span class="o">.</span><span class="n">labels</span> <span class="o">==</span> <span class="n">node</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span>
            
            <span class="c1"># initial displacements at begin and end nodes</span>
            <span class="n">U0nodes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">n</span><span class="p">,</span><span class="n">node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nodes</span><span class="p">):</span>
                <span class="n">U0nodes</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">U0</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nodes</span><span class="o">.</span><span class="n">labels</span> <span class="o">==</span> <span class="n">node</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span>
                
            <span class="c1"># RESOLVE PROBLEM IN STATEV UPDATE</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">nstatev</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">state_v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">state_v</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">state_v</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="c1"># internal forces at begin and end nodes</span>
            <span class="n">rnodes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">n</span><span class="p">,</span><span class="n">node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nodes</span><span class="p">):</span>
                <span class="n">rnodes</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nodes</span><span class="o">.</span><span class="n">labels</span> <span class="o">==</span> <span class="n">node</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span>
                
            <span class="n">mat_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Elements</span><span class="o">.</span><span class="n">get_material_type</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="c1">#elem_type = self.Elements.get_element_type(e)</span>
            
            <span class="k">if</span> <span class="n">mat_type</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">umat</span> <span class="o">=</span> <span class="n">umat_el</span>
            <span class="k">elif</span> <span class="n">mat_type</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">umat</span> <span class="o">=</span> <span class="n">umat_elplast_iso</span>
            <span class="k">elif</span> <span class="n">mat_type</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">umat</span> <span class="o">=</span> <span class="n">umat_elplast_kiniso</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="p">,</span><span class="n">state_v</span> <span class="o">=</span> <span class="n">truss</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">nodes</span><span class="p">,</span><span class="n">Xnodes</span><span class="p">,</span><span class="n">Unodes</span><span class="p">,</span><span class="n">U0nodes</span><span class="p">,</span><span class="n">rnodes</span><span class="p">,</span>
                                       <span class="bp">self</span><span class="o">.</span><span class="n">Nodes</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Elements</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span><span class="n">stage</span><span class="p">,</span>
                                       <span class="n">state_v</span><span class="p">,</span><span class="n">mat_prop</span><span class="p">,</span><span class="n">geo_prop</span><span class="p">,</span><span class="n">umat</span><span class="p">,</span>
                                       <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">statev_write</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">Settings</span><span class="o">.</span><span class="n">nstatev</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1">#print(&#39;write state-variable for element&#39;, int(e), state_v[0])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">state_v</span> <span class="o">=</span> <span class="n">state_v</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">lpf</span> <span class="o">=</span> <span class="n">lpf</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">Vred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Ured</span><span class="p">,</span><span class="n">lpf</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">stage</span> <span class="o">==</span> <span class="s1">&#39;G&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">g</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> \
                                  <span class="o">+</span>       <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">ExtForces</span><span class="o">.</span><span class="n">forces_const</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> \
                                  <span class="o">+</span> <span class="n">lpf</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">ExtForces</span><span class="o">.</span><span class="n">forces</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">g</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Analysis</span><span class="o">.</span><span class="n">DOF1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span></div>
    
    <span class="c1"># Plot Utilities from &quot;trusspy/tools/plot_utitilies.py&quot;</span>
<div class="viewcode-block" id="Model.plt_nodes"><a class="viewcode-back" href="../../api/trusspy.model.html#trusspy.model.Model.plt_nodes">[docs]</a>    <span class="k">def</span> <span class="nf">plt_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">config</span><span class="o">=</span><span class="s1">&#39;undeformed&#39;</span><span class="p">):</span>
        <span class="n">p_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">config</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="Model.plt_elements"><a class="viewcode-back" href="../../api/trusspy.model.html#trusspy.model.Model.plt_elements">[docs]</a>    <span class="k">def</span> <span class="nf">plt_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">config</span><span class="o">=</span><span class="s1">&#39;undeformed&#39;</span><span class="p">):</span>
        <span class="n">p_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">config</span><span class="p">)</span></div>

<div class="viewcode-block" id="Model.plt_extforces"><a class="viewcode-back" href="../../api/trusspy.model.html#trusspy.model.Model.plt_extforces">[docs]</a>    <span class="k">def</span> <span class="nf">plt_extforces</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">config</span><span class="o">=</span><span class="s1">&#39;undeformed&#39;</span><span class="p">):</span>
        <span class="n">p_extforces</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">config</span><span class="p">)</span></div>

<div class="viewcode-block" id="Model.plot_model"><a class="viewcode-back" href="../../api/trusspy.model.html#trusspy.model.Model.plot_model">[docs]</a>    <span class="k">def</span> <span class="nf">plot_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">config</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="n">view</span><span class="o">=</span><span class="s1">&#39;xz&#39;</span><span class="p">,</span><span class="n">contour</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">lim_scale</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span><span class="n">force_scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">cbar_limits</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span><span class="n">inc</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">p_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">config</span><span class="p">,</span><span class="n">view</span><span class="p">,</span><span class="n">contour</span><span class="p">,</span><span class="n">lim_scale</span><span class="p">,</span><span class="n">force_scale</span><span class="p">,</span><span class="n">cbar_limits</span><span class="p">,</span><span class="n">inc</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span></div>
           
<div class="viewcode-block" id="Model.plot_movie"><a class="viewcode-back" href="../../api/trusspy.model.html#trusspy.model.Model.plot_movie">[docs]</a>    <span class="k">def</span> <span class="nf">plot_movie</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">config</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="n">view</span><span class="o">=</span><span class="s1">&#39;xz&#39;</span><span class="p">,</span><span class="n">contour</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">lim_scale</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span><span class="n">force_scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">cbar_limits</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span><span class="n">incs</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">):</span>
        <span class="n">p_movie</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">config</span><span class="p">,</span><span class="n">view</span><span class="p">,</span><span class="n">contour</span><span class="p">,</span><span class="n">lim_scale</span><span class="p">,</span><span class="n">force_scale</span><span class="p">,</span><span class="n">cbar_limits</span><span class="p">,</span><span class="n">incs</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="Model.plot_history"><a class="viewcode-back" href="../../api/trusspy.model.html#trusspy.model.Model.plot_history">[docs]</a>    <span class="k">def</span> <span class="nf">plot_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">increments</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="s1">&#39;Displacement X&#39;</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="s1">&#39;LPF&#39;</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">p_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nodes</span><span class="p">,</span><span class="n">increments</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span></div>
    
<div class="viewcode-block" id="Model.plot_path"><a class="viewcode-back" href="../../api/trusspy.model.html#trusspy.model.Model.plot_path">[docs]</a>    <span class="k">def</span> <span class="nf">plot_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodepath</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">increment</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="s1">&#39;Displacement X&#39;</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">p_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nodepath</span><span class="p">,</span><span class="n">increment</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span></div>
        
<div class="viewcode-block" id="Model.plot_show"><a class="viewcode-back" href="../../api/trusspy.model.html#trusspy.model.Model.plot_show">[docs]</a>    <span class="k">def</span> <span class="nf">plot_show</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">p_show</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div></div>

        
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">Home</a>&#160;|</li>
        <li><a href="../../usage/getting_started.html">Quickstart</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Trusspy.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.3.
    </div>
  </body>
</html>